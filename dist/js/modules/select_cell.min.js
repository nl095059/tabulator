/* Tabulator v4.9.1 (c) Oliver Folkerd */
function clearHighlight(e){for(var t=e.columnManager.columnsByIndex,o=0;o<t.length;o++){t[o].cells.forEach(function(e){[CELL_SELECTED_CLASS,SELECTION_LEFT_CLASS,SELECTION_TOP_CLASS,SELECTION_RIGHT_CLASS,SELECTION_BOTTOM_CLASS].forEach(function(t){return e.getElement().classList.remove(t)})})}}function orderRectCoords(e,t){var o,l,n,c;return e.col>=t.col?(o=t.col,l=e.col):(o=e.col,l=t.col),e.row>=t.row?(n=t.row,c=e.row):(n=e.row,c=t.row),{startCol:o,startRow:n,endCol:l,endRow:c}}function highlightCells(e,t,o){for(var l=[],n=orderRectCoords(t,o),c=e.columnManager.columnsByIndex,s=n.startCol;s<=n.endCol;s++){c[s].cells.forEach(function(e){var o=e.row.parent.findRowIndex(e.row,e.row.parent.rows);if(o>=n.startRow&&o<=n.endRow){var c=e.getElement().classList;o==t.row&&s==t.col||c.add(CELL_SELECTED_CLASS),s==n.startCol&&c.add(SELECTION_LEFT_CLASS),s==n.endCol&&c.add(SELECTION_RIGHT_CLASS),o==n.startRow&&c.add(SELECTION_TOP_CLASS),o==n.endRow&&c.add(SELECTION_BOTTOM_CLASS),l.push(e)}})}return l}function createEmptySelection(){var e={row:0,col:0};return{start:e,end:e,data:[]}}var SELECTION_LEFT_CLASS="selection-left",SELECTION_RIGHT_CLASS="selection-right",SELECTION_TOP_CLASS="selection-top",SELECTION_BOTTOM_CLASS="selection-bottom",CELL_SELECTED_CLASS="tabulator-selected",SELECTABLE_CLASS="tabulator-selectable",UNSELECTABLE_CLASS="tabulator-unselectable",BLOCK_TABLE_TEXT_SELECTION="tabulator-block-select",SelectCell=function(e){this.table=e,this.selecting=!1,this.selection=createEmptySelection(),this.selectedRows=[],this.selectedCols=[]};SelectCell.prototype.clearSelectionData=function(){this.selecting=!1,this.selection=createEmptySelection(),this.selectedRows=[],this.selectedCols=[]},SelectCell.prototype.getSelection=function(){return this.selection},SelectCell.prototype.getSelectedRows=function(){return this.selectedRows.map(function(e){return e.getComponent()})},SelectCell.prototype.getSelectedColumns=function(){return this.selectedCols.map(function(e){return e.getComponent()})},SelectCell.prototype.changeSelection=function(e,t){var o=this;this.selection.start=e,this.selection.end=t,this.selectedRows=[],this.selectedCols=[],clearHighlight(this.table);var l=highlightCells(this.table,e,t),n=[],c=[];l.forEach(function(e){n.push(e.row),c.push(e.column)}),n.filter(function(e,t){return n.indexOf(e)==t}).forEach(function(e){return o.selectedRows.push(e)}),c.filter(function(e,t){return c.indexOf(e)==t}).forEach(function(e){return o.selectedCols.push(e)})},SelectCell.prototype.initializeCell=function(e){var t=this,o=e.getElement();if(o.classList.add(SELECTABLE_CLASS),o.classList.remove(UNSELECTABLE_CLASS),t.table.options.selectable&&"cell"==t.table.options.selectionType&&"highlight"!=t.table.options.selectable){var l=function(e){return{col:e.column.parent.findColumnIndex(e.column),row:e.row.parent.findRowIndex(e.row,e.row.parent.rows)}};o.addEventListener("mousedown",function(o){t.table._clearSelection(),t.table.element.classList.add(BLOCK_TABLE_TEXT_SELECTION),t.selectedRows=[],t.selectedCols=[],t.selecting=!0;var n=l(e);return t.changeSelection(n,n),!1}),o.addEventListener("mouseover",function(o){t.selecting&&t.changeSelection(t.selection.start,l(e))}),o.addEventListener("mouseup",function(o){t.selecting&&(t.selecting=!1,t.table.element.classList.remove(BLOCK_TABLE_TEXT_SELECTION),t.changeSelection(t.selection.start,l(e)))})}},Tabulator.prototype.registerModule("selectCell",SelectCell);