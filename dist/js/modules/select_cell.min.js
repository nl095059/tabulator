/* Tabulator v4.9.1 (c) Oliver Folkerd */
function clearHighlight(e){for(var t=e.columnManager.columnsByIndex,l=0;l<t.length;l++){t[l].cells.forEach(function(e){[CELL_SELECTED_CLASS,SELECTION_LEFT_CLASS,SELECTION_TOP_CLASS,SELECTION_RIGHT_CLASS,SELECTION_BOTTOM_CLASS].forEach(function(t){return e.getElement().classList.remove(t)})})}}function orderRectCoords(e,t){var l,o,n,s;return e.col>=t.col?(l=t.col,o=e.col):(l=e.col,o=t.col),e.row>=t.row?(n=t.row,s=e.row):(n=e.row,s=t.row),{startCol:l,startRow:n,endCol:o,endRow:s}}function highlightCells(e,t,l){for(var o=[],n=orderRectCoords(t,l),s=e.columnManager.columnsByIndex,c=n.startCol;c<=n.endCol;c++){s[c].cells.forEach(function(e){var l=e.row.parent.findRowIndex(e.row,e.row.parent.rows);l>=n.startRow&&l<=n.endRow&&(l==t.row&&c==t.col||e.getElement().classList.add(CELL_SELECTED_CLASS),c==n.startCol&&e.getElement().classList.add(SELECTION_LEFT_CLASS),c==n.endCol&&e.getElement().classList.add(SELECTION_RIGHT_CLASS),l==n.startRow&&e.getElement().classList.add(SELECTION_TOP_CLASS),l==n.endRow&&e.getElement().classList.add(SELECTION_BOTTOM_CLASS),o.push(e))})}return o}function createEmptySelection(){var e={row:0,col:0};return{start:e,end:e,data:[]}}var SELECTION_LEFT_CLASS="selection-left",SELECTION_RIGHT_CLASS="selection-right",SELECTION_TOP_CLASS="selection-top",SELECTION_BOTTOM_CLASS="selection-bottom",CELL_SELECTED_CLASS="tabulator-selected",SELECTABLE_CLASS="tabulator-selectable",UNSELECTABLE_CLASS="tabulator-unselectable",BLOCK_TABLE_TEXT_SELECTION="tabulator-block-select",SelectCell=function(e){this.table=e,this.selecting=!1,this.selection=createEmptySelection(),this.selectedRows=[],this.selectedCols=[]};SelectCell.prototype.clearSelectionData=function(){this.selecting=!1,this.selection=createEmptySelection(),this.selectedRows=[],this.selectedCols=[]},SelectCell.prototype.getSelection=function(){return this.selection},SelectCell.prototype.getSelectedRows=function(){return this.selectedRows.map(function(e){return e.getComponent()})},SelectCell.prototype.getSelectedColumns=function(){return this.selectedCols.map(function(e){return e.getComponent()})},SelectCell.prototype.changeSelection=function(e,t){var l=this;this.selection.start=e,this.selection.end=t,this.selectedRows=[],this.selectedCols=[],clearHighlight(this.table);var o=highlightCells(this.table,e,t),n=[],s=[];o.forEach(function(e){n.push(e.row),s.push(e.column)}),n.filter(function(e,t){return n.indexOf(e)==t}).forEach(function(e){return l.selectedRows.push(e)}),s.filter(function(e,t){return s.indexOf(e)==t}).forEach(function(e){return l.selectedCols.push(e)})},SelectCell.prototype.initializeCell=function(e){var t=this,l=e.getElement();if(l.classList.add(SELECTABLE_CLASS),l.classList.remove(UNSELECTABLE_CLASS),t.table.options.selectable&&"cell"==t.table.options.selectionType&&"highlight"!=t.table.options.selectable){var o=function(e){return{col:e.column.parent.findColumnIndex(e.column),row:e.row.parent.findRowIndex(e.row,e.row.parent.rows)}};l.addEventListener("mousedown",function(l){t.table._clearSelection(),t.table.element.classList.add(BLOCK_TABLE_TEXT_SELECTION),t.selectedRows=[],t.selectedCols=[],t.selecting=!0;var n=o(e);return t.changeSelection(n,n),!1}),l.addEventListener("mouseover",function(l){t.selecting&&t.changeSelection(t.selection.start,o(e))}),l.addEventListener("mouseup",function(l){t.selecting&&(t.selecting=!1,t.table.element.classList.remove(BLOCK_TABLE_TEXT_SELECTION),t.changeSelection(t.selection.start,o(e)))})}},Tabulator.prototype.registerModule("selectCell",SelectCell);