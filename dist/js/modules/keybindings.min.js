/* Tabulator v4.9.1 (c) Oliver Folkerd */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Keybindings=function(e){this.table=e,this.watchKeys=null,this.pressedKeys=null,this.keyupBinding=!1,this.keydownBinding=!1};Keybindings.prototype.initialize=function(){var e=this.table.options.keybindings,t={};if(this.watchKeys={},this.pressedKeys=[],!1!==e){for(var i in this.bindings)t[i]=this.bindings[i];if(Object.keys(e).length)for(var n in e)t[n]=e[n];this.mapBindings(t),this.bindEvents()}},Keybindings.prototype.mapBindings=function(e){var t=this,i=this;for(var n in e)!function(n){t.actions[n]?e[n]&&("object"!==_typeof(e[n])&&(e[n]=[e[n]]),e[n].forEach(function(e){i.mapBinding(n,e)})):console.warn("Key Binding Error - no such action:",n)}(n)},Keybindings.prototype.mapBinding=function(e,t){var i=this,n={action:this.actions[e],keys:[],ctrl:!1,shift:!1,meta:!1};t.toString().toLowerCase().split(" ").join("").split("+").forEach(function(e){switch(e){case"ctrl":n.ctrl=!0;break;case"shift":n.shift=!0;break;case"meta":n.meta=!0;break;default:e=parseInt(e),n.keys.push(e),i.watchKeys[e]||(i.watchKeys[e]=[]),i.watchKeys[e].push(n)}})},Keybindings.prototype.bindEvents=function(){var e=this;this.keyupBinding=function(t){var i=t.keyCode,n=e.watchKeys[i];n&&(e.pressedKeys.push(i),n.forEach(function(i){e.checkBinding(t,i)}))},this.keydownBinding=function(t){var i=t.keyCode;if(e.watchKeys[i]){var n=e.pressedKeys.indexOf(i);n>-1&&e.pressedKeys.splice(n,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)},Keybindings.prototype.clearBindings=function(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)},Keybindings.prototype.checkBinding=function(e,t){var i=this,n=!0;return e.ctrlKey==t.ctrl&&e.shiftKey==t.shift&&e.metaKey==t.meta&&(t.keys.forEach(function(e){-1==i.pressedKeys.indexOf(e)&&(n=!1)}),n&&t.action.call(i,e),!0)},Keybindings.prototype.bindings={navPrev:"shift + 9",navNext:9,navUp:"shift + 38",navDown:"shift + 40",navLeft:"shift + 37",navRight:"shift + 39",scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35,undo:"ctrl + 90",redo:"ctrl + 89",copyToClipboard:"ctrl + 67"},Keybindings.prototype.actions={keyBlock:function(e){e.stopPropagation(),e.preventDefault()},scrollPageUp:function(e){var t=this.table.rowManager,i=t.scrollTop-t.height;t.element.scrollHeight;e.preventDefault(),t.displayRowsCount&&(i>=0?t.element.scrollTop=i:t.scrollToRow(t.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(e){var t=this.table.rowManager,i=t.scrollTop+t.height,n=t.element.scrollHeight;e.preventDefault(),t.displayRowsCount&&(i<=n?t.element.scrollTop=i:t.scrollToRow(t.getDisplayRows()[t.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(e){var t=this.table.rowManager;e.preventDefault(),t.displayRowsCount&&t.scrollToRow(t.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(e){var t=this.table.rowManager;e.preventDefault(),t.displayRowsCount&&t.scrollToRow(t.getDisplayRows()[t.displayRowsCount-1]),this.table.element.focus()},navPrev:function(e){var t=!1;this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell)&&(e.preventDefault(),t.nav().prev())},navNext:function(e){var t,i=!1,n=this.table.options.tabEndNewRow;this.table.modExists("edit")&&(i=this.table.modules.edit.currentCell)&&(e.preventDefault(),t=i.nav(),t.next()||n&&(i.getElement().firstChild.blur(),n=!0===n?this.table.addRow({}):"function"==typeof n?this.table.addRow(n(i.row.getComponent())):this.table.addRow(Object.assign({},n)),n.then(function(){setTimeout(function(){t.next()})})))},navLeft:function(e){var t=!1;if(this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell)&&(e.preventDefault(),t.nav().left()),this.table.modExists("selectCell")){var i=this.table.modules.selectCell;i.selection.end.col>0&&i.selection.end.col--,i.changeSelection(i.selection.start,i.selection.end)}},navRight:function(e){var t=!1;if(this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell)&&(e.preventDefault(),t.nav().right()),this.table.modExists("selectCell")){var i=this.table.modules.selectCell;i.selection.end.col<this.table.columnManager.columns.length-1&&i.selection.end.col++,i.changeSelection(i.selection.start,i.selection.end)}},navUp:function(e){var t=!1;if(this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell)&&(e.preventDefault(),t.nav().up()),this.table.modExists("selectCell")){var i=this.table.modules.selectCell;i.selection.end.row>0&&i.selection.end.row--,i.changeSelection(i.selection.start,i.selection.end)}},navDown:function(e){var t=!1;if(this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell)&&(e.preventDefault(),t.nav().down()),this.table.modExists("selectCell")){var i=this.table.modules.selectCell;i.selection.end.row<this.table.rowManager.getVisibleRows().length-1&&i.selection.end.row++,i.changeSelection(i.selection.start,i.selection.end)}},undo:function(e){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(e.preventDefault(),this.table.modules.history.undo()))},redo:function(e){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(e.preventDefault(),this.table.modules.history.redo()))},copyToClipboard:function(e){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}},Tabulator.prototype.registerModule("keybindings",Keybindings);